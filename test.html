<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Scrolling Map</title>
        <link
            rel="stylesheet"
            href="https://unpkg.com/leaflet/dist/leaflet.css"
        />
        <style>
            body {
                margin: 0;
                height: 8000vh; /* Increase the height for scrolling */
                background: black;
            }
            #content {
                position: relative;
            }
            #map {
                position: fixed; /* Fix the map in place */
                top: 0;
                left: 0;
                width: 100%;
                height: 100vh; /* Set the height of the map */
                z-index: -1;
            }
            #article-container {
                position: absolute;
                z-index: 10;
                margin-top: 25%;
                & .article-text {
                    color: white;
                    background: black;
                    padding: 20px;
                    font-size: 14px;
                }
            }

            .city {
                height: 800vh; /* 8000vh total / 10 schools */
                width: 40%;
                margin-left: auto;
                margin-right: 5%;
                & img {
                    width: 100%;
                }
            }
            .photo-container {
                position: relative;
                margin: 20px 0;
            }

            .caption {
                position: absolute;
                bottom: 40px;
                left: 16px;
                z-index: 20;
            }

            .paper-label {
                margin-top: 25%;
                z-index: 5;
                & td {
                    padding: 10px;
                }
                background: white;

                width: 40%;
            }
            .paper-logo {
                width: 25%;
            }
            .paper-info {
                width: 75%;
            }

            @media screen and (max-width: 989px) {
                .city {
                    width: 80%;
                    margin: 0 auto !important;
                }
                .paper-label {
                    width: 100%;
                    margin-top: 1000%;
                }
            }
        </style>
    </head>
    <body>
        <div id="content">
            <div id="map"></div>
            <div
                id="logo"
                style="width: 200px; margin: 20px auto; display: block"
            >
                <img
                    src="https://dailytrojan.com/images-dte/dt14.png"
                    style="width: 100%"
                />
            </div>
            <div id="article-container">
                <div class="city" id="us-wide">
                    <div class="article-text">
                        <p>
                            <strong>We are always moving through time.</strong>
                            It is a constant for everyone on earth. Through
                            photography, there is a rare opportunity to freeze a
                            moment in time in an image. In a unique and new
                            collaboration, college newspapers The Battalion, The
                            Crimson White, the Daily Bruin, The Daily
                            Californian, The Daily Texan, the Daily Trojan, The
                            Daily Wildcat, The Scarlet & Black, The Vanderbilt
                            Hustler and Washington Square News teamed up to
                            capture one hour of time across the country. With
                            schools in every American time zone, on Oct. 9 at 8
                            a.m. PDT, student photojournalists worked across the
                            country to capture their school and environment. As
                            soon as 9 a.m. struck, all of the photography
                            ceased. Those photos taken in that one hour have
                            been compiled together to create “A Moment in Time,”
                            a first-of-its-kind, collaborative photo essay.
                        </p>
                    </div>
                    <div style="height: 100vh"></div>
                    <div
                        class="article-text"
                        style="text-align: center !important"
                    >
                        <h6>THE WEEKLY FRAME II</h6>
                        <h2>A Moment in Time</h2>
                    </div>
                </div>
                <div class="city" id="usc">
                    <table class="paper-label" id="daily-trojan">
                        <tr>
                            <td class="paper-logo">
                                <img
                                    src="https://dailytrojan.com/wp-content/uploads/2015/02/DT-facebook1.png"
                                />
                            </td>
                            <td class="paper-info">
                                <h4>Daily Trojan</h4>
                                <h6>University of Southern California</h6>
                            </td>
                        </tr>
                    </table>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                </div>
                <div class="city" id="texas-am">
                    <table class="paper-label" id="battalion">
                        <tr>
                            <td class="paper-logo">
                                <img
                                    src="https://thebatt.com/wp-content/uploads/2024/01/B-Batt-70x70.png"
                                />
                            </td>
                            <td class="paper-info">
                                <h4>The Battalion</h4>
                                <h6>Texas A&M</h6>
                            </td>
                        </tr>
                    </table>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                    <div class="photo-container">
                        <img
                            class="photo-container"
                            src="https://placehold.co/600x400/png"
                        />
                        <div class="caption">
                            Caption (Photographer / Daily Trojan)
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
        <script>
            // Initialize the map
            const map = L.map("map", {
                scrollWheelZoom: false, // Disable zoom with the mouse wheel
                keepBuffer: 300, // Preload tiles in a 3-tile radius around the viewport
            }).setView([37.0902, -95.7129], 5); // Start view (US)

            // Add OpenStreetMap tiles to the main map
            const mainLayer = L.tileLayer(
                "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
                {
                    maxZoom: 19,
                    attribution: "© OpenStreetMap contributors",
                    noWrap: true, // Avoid wrapping tiles beyond map bounds
                },
            ).addTo(map);
            // Define cities with their coordinates and zoom levels
            const cities = [
                { name: "United States", coords: [37.0902, -95.7129], zoom: 5 },
                {
                    name: "University of Southern California",
                    coords: [34.02174, -118.27836],
                    zoom: 16,
                },
                {
                    name: "Texas A&M University",
                    coords: [30.60246, -96.30392],
                    zoom: 13,
                },
                {
                    name: "University of Alabama",
                    coords: [33.21206, -87.53865],
                    zoom: 16,
                },
                { name: "UCLA", coords: [34.06782, -118.44641], zoom: 16 },
                {
                    name: "University of Texas at Austin",
                    coords: [30.28322, -97.73247],
                    zoom: 16,
                },
                {
                    name: "University of Arizona",
                    coords: [32.23383, -110.95009],
                    zoom: 16,
                },
                {
                    name: "Grinnell College",
                    coords: [41.751319, -92.718635],
                    zoom: 17,
                },
                {
                    name: "Vanderbilt University",
                    coords: [36.14376, -86.80445],
                    zoom: 16,
                },
                {
                    name: "New York University",
                    coords: [40.7291, -73.995894],
                    zoom: 17,
                },
            ];

            // Interpolate between two cities
            function interpolateCoords(startCoords, endCoords, factor) {
                return [
                    startCoords[0] + (endCoords[0] - startCoords[0]) * factor,
                    startCoords[1] + (endCoords[1] - startCoords[1]) * factor,
                ];
            }

            function getResponsiveZoom(city) {
                const screenWidth = window.innerWidth;

                if (screenWidth < 767) {
                    return city.zoom - 2; // Zoom in more on smaller screens
                } else if (screenWidth < 989) {
                    return city.zoom - 1; // Moderate zoom for medium screens
                } else {
                    return city.zoom; // Default zoom for larger screens
                }
            }

            // Handle scroll event
            window.addEventListener("scroll", () => {
                const scrollY = window.scrollY;
                const totalHeight =
                    document.body.scrollHeight - window.innerHeight;

                // Determine the relative scroll position (0 to 1)
                const scrollPosition = scrollY / totalHeight;

                // Calculate how much to stay on a city before moving (e.g., 20% of the scroll per city)
                const stayFactor = 0.5;
                const moveFactor = 1 - stayFactor; // Remaining time for transition

                // Determine which two cities to interpolate between
                const sectionSize = 1 / cities.length; // The size of each scroll section
                const sectionIndex = Math.floor(scrollPosition / sectionSize);
                const relativePosition =
                    (scrollPosition % sectionSize) / sectionSize;

                if (sectionIndex < cities.length) {
                    const currentCity = cities[sectionIndex];

                    if (relativePosition < stayFactor) {
                        // Stay at the current city
                        map.setView(
                            currentCity.coords,
                            getResponsiveZoom(currentCity),
                            {
                                animate: false,
                            },
                        );
                    } else {
                        // Move gradually toward the next city, if there is one
                        if (sectionIndex < cities.length - 1) {
                            const nextCity = cities[sectionIndex + 1];
                            const moveProgress =
                                (relativePosition - stayFactor) / moveFactor;
                            const interpolatedCoords = interpolateCoords(
                                currentCity.coords,
                                nextCity.coords,
                                moveProgress,
                            );

                            const interpolatedZoom =
                                getResponsiveZoom(currentCity) +
                                (getResponsiveZoom(nextCity) -
                                    getResponsiveZoom(currentCity)) *
                                    moveProgress;

                            map.setView(interpolatedCoords, interpolatedZoom, {
                                animate: false,
                            });
                        }
                    }
                }
            });
            window.onload = function () {
                window.scrollTo(0, 0); // Scroll to the top
                map.setView(cities[0].coords, cities[0].zoom); // Set the map view to the initial city (United States)
            };
        </script>
    </body>
</html>
